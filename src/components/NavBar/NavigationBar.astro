---
import ThemeToggler from "./ThemeToggler.astro";
import Logo from "./Logo.astro";
---

<nav>
  <Logo />
  <button class="hamburger-toggle" aria-label="Toggle navigation menu">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
  </button>
  <ul class="nav-links">
    <li>
      <a href="./">Home</a>
    </li>
    <li>
      <a href="./portfolios">Portfolios</a>
    </li>
    <li>
      <a href="./philosophy">Philosophy</a>
    </li>
    <li>
      <a href="./analytics">Analytics</a>
    </li>
    <li>
      <a href="./about">About us</a>
    </li>
    <li>
      <a href="./contact">Contact</a>
    </li>
  </ul>
  <ThemeToggler />
</nav>

<style>
  nav {
    position: fixed;
    border-radius: var(--radius);
    top: 0;
    width: calc(100vw - 3rem);
    width: calc(100dvw - 3rem);
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: 0 3rem 0 3rem;
    background-color: rgb(from var(--background) r g b/0.9);
    z-index: 50;
  }

  ul {
    display: flex;
    flex-wrap: wrap;
    align-items: stretch;
    padding: 0;
    margin: 0;
  }

  nav li {
    opacity: 0.8;
    list-style: none;
    font-size: 1.2rem;
  }

  a {
    padding: 0.5rem 1rem;
    border-radius: 10px;
    text-decoration: none;
    color: var(--accent);
  }

  a:hover {
    background-color: var(--accent);
    color: var(--background);
  }

  a.active {
    background: var(--accent);
    color: var(--background);
  }

  .hamburger-toggle {
    display: none;
    /* Add styling for button reset/appearance */
    background: none;
    border: none;
    cursor: pointer;
    padding: 0; /* Remove default padding */
    z-index: 100;
  }

  .hamburger-toggle .bar {
    display: block;
    width: 25px;
    height: 3px;
    margin: 5px 0;
    background-color: var(--accent); /* Using your accent color */
    transition: 0.4s;
  }

  @media (max-width: 768px) {
    /* 1. Show the hamburger button */
    .hamburger-toggle {
      display: block;
    }

    /* 2. Overwrite the navigation padding for mobile to give the drawer space */
    nav {
      /* Adjust width to full screen for mobile drawer */
      width: 100vw;
      width: 100dvw;
      padding: 0 1.5rem; /* Reduced padding for mobile */
      align-items: center; /* Center items vertically */
    }

    /* 3. Transform the UL into a hidden vertical drawer */
    .nav-links {
      /* Overwrite the desktop 'display: flex' */
      display: flex;
      flex-direction: column; /* Links become vertical */

      /* Position absolutely off-screen */
      position: fixed;
      top: 50px; /* Adjust based on your nav height */
      right: 0; /* Start from the right side */

      width: 70%; /* Drawer width */
      height: 100vh; /* Full screen height */
      padding: 20px 0;

      /* Use a darker/different background for contrast */
      background-color: var(--background);

      /* Start hidden: Use 'transform' to slide it off-screen to the right */
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;

      /* Ensure it overlaps content, but stays behind the toggle button */
      z-index: 49;
    }

    /* 4. Class added by JavaScript to show the drawer */
    .nav-links.open {
      transform: translateX(0); /* Slide into view */
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2); /* Optional shadow */
    }

    /* 5. Ensure links fill the drawer width */
    .nav-links li {
      width: 100%;
    }

    /* 6. Increase link padding for better touch targets */
    .nav-links li a {
      padding: 1rem 1.5rem;
      border-radius: 0;
    }
  }
</style>

<script>
  const { pathname } = window.location;
  const activeNavigationElement = document.querySelector(
    `nav a[href="${pathname}"]`
  );

  if (activeNavigationElement) {
    activeNavigationElement.classList.add("active");
  }

  document.addEventListener("DOMContentLoaded", () => {
    const hamburgerToggle = document.querySelector(".hamburger-toggle");
    const navLinks = document.querySelector(".nav-links");

    hamburgerToggle.addEventListener("click", () => {
      // Toggle the 'open' class on the menu to show/hide it
      navLinks.classList.toggle("open");

      // Optional: Toggle a class on the button itself to animate the icon (e.g., to an 'X')
      hamburgerToggle.classList.toggle("is-active");
    });

    // Optional: Close the menu when a link is clicked
    navLinks.querySelectorAll("a").forEach((link) => {
      link.addEventListener("click", () => {
        if (navLinks.classList.contains("open")) {
          navLinks.classList.remove("open");
          hamburgerToggle.classList.remove("is-active");
        }
      });
    });
  });
</script>
